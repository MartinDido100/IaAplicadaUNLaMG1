<div class="catalog-container">
  <!-- Barra de búsqueda -->
  <div class="search-section">
    <h1 class="catalog-title">Catálogo de Películas</h1>
    <div class="search-bar">
      <div class="search-input-container">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        <input 
          type="text" 
          placeholder="Buscar películas..."
          class="search-input"
          #searchInput>
      </div>
      <button class="search-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"/>
          <path d="m21 21-4.35-4.35"/>
        </svg>
        Buscar
      </button>
    </div>
  </div>

  <!-- Filtros opcionales -->
  <div class="filters-section">
    <div class="filters-container">
      <select class="filter-select" #genreSelect [disabled]="isLoading()">
        <option value="">Todos los géneros</option>
        @for (genre of mS.genres(); track genre.id) {
          <option [value]="genre.id">{{ genre.name }}</option>
        }
      </select>
      
      <select class="filter-select" #yearSelect [disabled]="isLoading()">
        <option value="">Año</option>
        <option value="2024">2024</option>
        <option value="2023">2023</option>
        <option value="2022">2022</option>
        <option value="2021">2021</option>
        <option value="2020">2020</option>
      </select>

      <button class="filter-btn" [disabled]="isLoading()" (click)="applyFilters()">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
        </svg>
        Filtrar
      </button>

      @if (hasActiveFilters && !isLoading()) {
        <button class="clear-filters-btn" (click)="clearFilters()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 6h18"/>
            <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
            <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
            <line x1="10" x2="10" y1="11" y2="17"/>
            <line x1="14" x2="14" y1="11" y2="17"/>
          </svg>
          Limpiar filtros
        </button>
      }
    </div>
  </div>

  @if(isLoading()){
      <div class="skeleton-grid">
        @for (i of [1,2,3,4]; track i) {
          <div class="movie-skeleton">
            <app-skeleton width="100%" height="300px" borderRadius="12px 12px 0 0"></app-skeleton>
            <div class="skeleton-content">
              <app-skeleton width="80%" height="20px" borderRadius="4px"></app-skeleton>
              <div class="skeleton-info">
                <app-skeleton width="40%" height="16px" borderRadius="4px"></app-skeleton>
                <app-skeleton width="50%" height="16px" borderRadius="4px"></app-skeleton>
              </div>
              <div class="skeleton-genres">
                <app-skeleton width="60px" height="24px" borderRadius="12px"></app-skeleton>
                <app-skeleton width="80px" height="24px" borderRadius="12px"></app-skeleton>
                <app-skeleton width="70px" height="24px" borderRadius="12px"></app-skeleton>
              </div>
              <app-skeleton width="100%" height="16px" borderRadius="4px"></app-skeleton>
              <app-skeleton width="90%" height="16px" borderRadius="4px"></app-skeleton>
              <app-skeleton width="75%" height="16px" borderRadius="4px"></app-skeleton>
            </div>
          </div>
        }
      </div>
  }@else{
      <div class="movies-grid content-grid" [style.display]="!isLoading() ? 'grid' : 'none'">
        @for (movie of movies(); track movie.id) {
          <app-movie-card [movie]="movie"></app-movie-card>
        }
      </div>
  }


  <!-- Paginación -->
  <div class="pagination-section" [class.loading]="isLoading()">
    <div class="pagination">
      <button class="pagination-btn" [disabled]="currentPage() <= 1 || isLoading()" (click)="goToPage(currentPage() - 1)">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
        Anterior
      </button>
      
      <div class="pagination-numbers">
        @for (page of getVisiblePages(); track page) {
          @if (page === '...') {
            <span class="pagination-dots">...</span>
          } @else {
            <button 
              class="pagination-number" 
              [class.active]="page === currentPage()"
              [disabled]="isLoading()"
              (click)="goToPage(page)">
              {{ page }}
            </button>
          }
        }
      </div>
      
      <button class="pagination-btn" [disabled]="currentPage() >= totalPages() || isLoading()" (click)="goToPage(currentPage() + 1)">
        Siguiente
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </button>
    </div>
  </div>
</div>
